# Stargate_value-v1.0
Скрипт для прогона объёма с минимальными затратами через Stargate с вводом и выводом через OKX.

Часть с управлением OKX-аккаунта позаимствовали у https://t.me/hodlmodeth, немного переписав, спасибо им за опенсорс-контент :)

## Особенности скрипта
* Вывод USDC из OKX в сетях POLYGON, AVALANCHE, ARBITRUM, OPTIMISM
* Проверка `fee` на Stargate по вашим маршрутам
* Отправка транзакции на бридж, если `fee` удовлетворяет вашей настройке
* Вывод USDC на указанный кошелек (например, OKX)
* Логирование всех действий

## Пример работы скрипта
1. Перед запуском, в `settings_execute.py` на строке `max_fee` был указан 0.16
2. Скрипт мониторит `EQ fee`, пока не найдет маршрут, где Stargate возместит всю сумму, кроме $0.16
3. Например, появилась связка `POLYGON` - `AVALANCHE`. Скрипт отправляет рандомную сумму в ренже на `POLYGON`
4. Скрипт заранее апрувает бридж и начинает мониторить маршруты из `POLYGON`, пока повторно не найдет маршрут с `fee` дешевле $0.16
5. Маршрут нашелся, USDC забриджились
6. Как только токены появятся на кошельке, скрипт сразу же отправляет их на указанный кошелек (OKX, в нашем случае)
7. Как только токены становятся доступны на бирже, скрипт переходит к следующему кошельку

## Настройка скрипта
### **`settings_execute.py`**  
`WAIT_MIN` - время ожидания между действиями. Советуем ставить малые значения, например "5, 10"  

`CHECK_FEE_LIST` - список сетей для поиска маршрутов. Поиск маршрутов начинается сверху. Приоритет отдается первому найденному маршруту  
Маршруты можно менять и добавлять свои в формате, как представлено ниже:  
```
    {
    'network_from':'Arbitrum', 
    'network_to_list':['Optimism', 'Polygon']
     },
```

`MAX_FEE` - максимальная комиссия за бридж, ака EQ fee  

![](https://i.ibb.co/Wz1NnQW/photo-2023-07-11-19-25-11.jpg)

`OKX` - данные от API ключа OKX  
`OKX_PROXY` - прокси для вывода с OKX, в случае, если без прокси не работает. Заполнять в формате `http://user:pass@10.10.1.10:1080`  

### **`max_setting.csv`**

`MAX_GAS` - максимальная стоимость комиссии за транзакцию  
`MAX_VALUE` - максимальная стоимость (value) бриджа

### **`data.csv`**

`DO` - нужно ли прогонять кошелек: английская X - да, DONE или пусто - нет  
`NAME` - имя кошелька, для удобства  
`WALLET` - адрес кошелька  
`PRIVATE_KEY`	- приватный ключ кошелька  
`OKX_WALLET` - уникальный кошелек OKX, куда отправлять токены после бриджа  
`VALUE_RANGE`	- диапазон USDC для прогона в формате `500.0,548.2`. Десятичная часть числа отделяется точкой "."  
`OKX_OUT` - поле для логов. По умолчанию пустое	
`TIMES`	- сколько раз прогнать кошелек. По умолчанию 1 или 0. **НЕ** оставлять пустым  
`VALUE_STARGATE` - поле для логов. Показывает, какую сумму выбрал из диапазона, указанного в `VALUE_RANGE`. По умолчанию пустое  
`FROM` - поле для логов. Сначала показывает, какую source сеть выбрал для прогона, после бриджа заменяется на destination сеть. По умолчанию пустое  
`OKX_IN` - поле для логов. Показывает, дошли ли деньги на OKX. По умолчанию пустое

## Примечания
* Исполняемый файл - execute.py
* Удостоверьтесь, что кошельки, которые вы собрались прогонять, добавлены в вайтлист на OKX для каждой сети, которую вы решили оставить. Удобный скрипт для добавления кошельков https://thorlab.io/
* Самый часто встречающийся маршрут - `POLYGON` - `ARBITRUM`. Средние затраты на прогон 5000 USDC - 0.95$  
* Самый дешевый, но редкий маршрут - `OPTIMISM` - `POLYGON`. Средние затраты на прогон 5000 USDC - 0.25$  
* Среднее время на прогон 1 кошелька - 30 минут  
* Скрипт рассчитан на прогон каждого кошелька по 1 разу. Иначе деньги могут надолго застрять, ища доступные связки, либо в пути.  

**Скрипт узнает комиссию из контрактов StargateFeeLibraryV***  
**При запуске проверяйте, не изменился ли контракт (версия) на https://stargateprotocol.gitbook.io/stargate/developers/contract-addresses/mainnet**

**ТРИЖДЫ ПЕРЕПРОВЕРЬТЕ ПРАВИЛЬНОСТЬ ЗАПОЛНЕНИЯ `data.csv`!!!**  
**УБЕДИТЕСЬ, ЧТО КОШЕЛЬКИ OKX УКАЗАНЫ ВЕРНО**

